var global=this;(function(){var e={isPresent:function(j,i){return !!j},isBlank:function(j,i){return !j},equalTo:function(j,i){return""+j===""+i},notEqualTo:function(j,i){return""+j!==""+i},greaterThan:function(j,i){return parseFloat(j)>parseFloat(i)},greaterThanEqual:function(j,i){return parseFloat(j)>=parseFloat(i)},lessThan:function(j,i){return parseFloat(j)<parseFloat(i)},lessThanEqual:function(j,i){return parseFloat(j)<=parseFloat(i)},isIn:function(m,l){var k=l.split("|");if(k.length>0){for(var j=0;j<k.length;j++){if(m&&m.indexOf(k[j])>-1){return true}}}return m&&m.indexOf(l)>-1},isNotIn:function(m,l){var k=l.split("|");if(k.length>0){for(var j=0;j<k.length;j++){if(m&&m.indexOf(k[j])===-1){return true}}}return m&&m.indexOf(l)===-1},startsWith:function(j,i){return j&&j.indexOf(i)===0},endsWith:function(j,i){return j&&j.indexOf(i,j.length-i.length)!==-1},isBefore:function(j,i){return new Date(j).getTime()<new Date(i).getTime()},isAfter:function(j,i){return new Date(j).getTime()>new Date(i).getTime()},isChecked:function(j,i){return !!j},isNotChecked:function(j,i){return !j},hasFileSelected:function(j,i){return !!j},hasNoFileSelected:function(j,i){return !j},hasBeenClicked:function(j,i){return !!j},hasBeenSubmitted:function(j,i){return options.submitted}};var d=global.RuleEngine=function d(i){i=i||{};this.id=Utils.hashCode(JSON.stringify(i.conditions));this.operators={};this.actions=i.actions||[];this.conditions=i.conditions||{all:[]};this.addOperators(e)};d.prototype={run:function(j,o,m,i){var l,k,n=this;this.matches(j,function(q,p){l=p;k=q;if(p&&!q){n.runActions(o)}else{if(!p&&!q&&options.runOppositeActions){n.runOppositeActions(m,o)}}if(i){i(q,p)}});if(k){throw k}return l},matches:function(j,i){var k,l;c(this.conditions,j,this,function(n,m){if(n){l=n;console.log("ERR",n.message,n.stack)}k=m;if(i){i(n,m)}});if(l){throw l}if(!i){return k}},operator:function(i){return this.operators[i]},addOperators:function(j){var k=this;for(var i in j){if(j.hasOwnProperty(i)){(function(){var l=j[i];if(l.length==2){k.operators[i]=function(q,p,n){try{var m=l(q,p);n(null,m)}catch(o){n(o)}}}else{if(l.length==3){k.operators[i]=l}else{throw"Operators should have an arity of 2 or 3; "+i+" has "+l.length}}})()}}},runActions:function(n){for(var l=0;l<this.actions.length;l++){var m=this.actions[l];var k=m.value;var j=n[k];if(j){j(new g(m),this.id)}}},runOppositeActions:function(n,o){for(var l=0;l<this.actions.length;l++){var m=this.actions[l];var k=n[m.value];var j=o[k];if(j){j(new g(m),this.id)}}}};function g(i){this.data=i}g.prototype={find:function(){var l=this.data;for(var k=0;k<arguments.length;k++){var j=arguments[k];l=b(j,l);if(!l){return null}}return l.value}};function b(k,m){var j=m.fields||[];for(var l=0;l<j.length;l++){var n=j[l];if(n.name===k){return n}}return null}function c(k,l,j,i){if(k.all||k.any||k.none){h(k,l,j,i)}else{a(k,l,j,i)}}function h(l,q,u,m){try{var v=!!l.all;var s=!!l.any;var n=!!l.none;var j=v?l.all:l.any;if(n){j=l.none}if(j.length==0){return m(null,true)}var k,p=0;var r=function(){try{k=j[p];p++;if(k){c(k,q,u,o)}else{var i=n?true:v;m(null,i)}}catch(w){m(w)}};var o=function(w,i){if(w){return m(w)}if(v&&!i){return m(null,false)}if(s&&!!i){return m(null,true)}if(n&&!!i){return m(null,false)}r()};r()}catch(t){m(t)}}function a(k,n,j,i){try{var l=n[k.name];if(l&&l.call){if(l.length===1){return l(function(o){f(o,k.operator,k.value,j,i)})}else{l=l()}}f(l,k.operator,k.value,j,i)}catch(m){i(m)}}function f(o,j,m,k,i){try{var l=k.operator(j);if(!l){throw"Missing "+j+" operator"}l(o,m,i)}catch(n){i(n)}}if(typeof module!=="undefined"){module.exports=d;delete global.RuleEngine}})();