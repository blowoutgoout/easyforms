$(document).ready(function(){var s="#475e98";var r="#9B59B6";var q="#F8B700";var o="#78CC00";var m="#7B71C5";var l="#56B2EA";var j="#E064CD";var g=[s,r,q,o,m,l,j];var n=dc.lineChart("#date-chart");var k=dc.barChart("#hour-chart");var i=dc.pieChart("#ismobile-chart");var c=dc.rowChart("#browser-chart");var p=dc.pieChart("#os-chart");var a=dc.pieChart("#device-chart");var e=dc.pieChart("#referrer-chart");var h=dc.rowChart("#domain-chart");var b=dc.geoChoroplethChart("#world-chart");var f=dc.rowChart("#city-chart");var d=dc.rowChart("#sessions-chart");d3.csv(options.endPoint,function(Z){var B=d3.time.format("%Y");var O=d3.time.format("%B");var Q=d3.time.format("%A");var y=d3.time.format("%H");var Y=d3.time.format("%m/%d/%Y");Z.forEach(function(ab){ab.time=+ab.collector_tstamp;ab.date=new Date(+ab.time*1000);ab.year=B(ab.date);ab.day=Y(ab.date);ab.hour=+y(ab.date);ab.monthName=O(ab.date);ab.dayName=Q(ab.date)});var x=crossfilter(Z);var u=x.groupAll();var R=x.dimension(function(ab){return ab.time});var v=x.dimension(function(ab){return d3.time.day.floor(ab.date)});var P=v.group();var K=x.dimension(function(ab){return ab.hour});var F=K.group();var aa=x.dimension(function(ac){var ab=+ac.dvce_ismobile;return ab?options.i18n.yes:options.i18n.no});var C=aa.group();var M=x.dimension(function(ab){return ab.br_family});var V=M.group();var L=x.dimension(function(ab){return ab.os_family});var I=L.group();var U=x.dimension(function(ab){return ab.dvce_type});var T=U.group();var J=x.dimension(function(ab){return ab.refr_medium});var X=J.group();var E=x.dimension(function(ab){return ab.refr_urlhost});var A=E.group();var S=x.dimension(function(ab){return ab.geo_country});var N=S.group();var H=x.dimension(function(ab){return ab.geo_city});var t=H.group();var D=x.dimension(function(ab){var ac;if(ab.domain_sessionidx<2){ac="1"}else{if(ab.domain_sessionidx<3){ac="2"}else{if(ab.domain_sessionidx<4){ac="3"}else{if(ab.domain_sessionidx<5){ac="4"}else{if(ab.domain_sessionidx<6){ac="5"}else{if(ab.domain_sessionidx<7){ac="6"}else{if(ab.domain_sessionidx<8){ac="7"}else{ac="8 +"}}}}}}}return ac});var W=D.group();dc.dataCount(".data-count").dimension(x).group(u);var G=(typeof v.bottom(1)[0]!="undefined")?d3.time.day.floor(v.bottom(1)[0].date):0;var w=(typeof v.top(1)[0]!="undefined")?d3.time.day.floor(v.top(1)[0].date):0;n.width($("#date").width()).height(250).x(d3.time.scale().domain([G,w])).elasticX(true).elasticY(true).renderHorizontalGridLines(true).brushOn(false).renderDataPoints(true).ordinalColors(g).clipPadding(10).dimension(v).group(P);k.width($("#hour").width()).height(250).x(d3.scale.linear().domain([0,24])).renderHorizontalGridLines(true).brushOn(false).ordinalColors(g).dimension(K).group(F);i.width($("#ismobile").width()).height(220).radius(100).dimension(aa).ordinalColors(g).group(C).label(function(ac){if(i.hasFilter()&&!i.hasFilter(ac.key)){return ac.key+" (0%)"}var ab=ac.key;if(u.value()){ab+=" ("+Math.floor(ac.value/u.value()*100)+"%)"}return ab}).renderLabel(true);c.width($("#browser").width()).height(230).margins({top:0,left:10,right:10,bottom:20}).dimension(M).group(V).ordinalColors(g).elasticX(true).xAxis().ticks(4);p.width($("#os").width()).height(220).radius(100).dimension(L).ordinalColors(g).group(I).renderLabel(true);a.width($("#device").width()).height(220).radius(100).dimension(U).ordinalColors(g).group(T).renderLabel(true);var z=$("#referrer").width();e.width(z).height(230).radius(100).innerRadius(75).dimension(J).ordinalColors(g).group(X).renderLabel(false).renderTitle(true).legend(dc.legend().x(Math.round((z*50/100)-24)).y(80).itemHeight(13).gap(5));h.width($("#domain").width()).height(230).margins({top:0,left:10,right:10,bottom:20}).dimension(E).group(A).ordinalColors(g).elasticX(true).data(function(ab){return ab.top(8)}).xAxis().ticks(4);f.width($("#city").width()).height(440).margins({top:0,left:10,right:10,bottom:20}).group(t).dimension(H).ordinalColors(g).elasticX(true).data(function(ab){return ab.top(10)}).xAxis().ticks(4);d.width($("#sessions").width()).height(240).margins({top:0,left:10,right:10,bottom:20}).group(W).dimension(D).ordinalColors(g).elasticX(true).xAxis().ticks(4);d3.json(options.countriesJSON,function(af){var ah=$("#world").width();var ac=Math.round(ah*60/100);var ae=Math.round(ah*13/100);var ad=Math.round(ah*45/100);var ag=Math.round(ac*50/100);var ab=d3.geo.mercator().center([0,40]).scale(ae).translate([ad,ag]).rotate([-12,0]);b.width(ah).height(ac).dimension(S).group(N).projection(ab).colors(d3.scale.quantize().range(["#BAD1FF","#ADC4FE","#94ABE5","#7A91CB","#6178B2","#475E98","#2E457F","#142B65","#00124C","#000032"])).colorDomain([0,200]).colorCalculator(function(ai){return ai?b.colors()(ai):"#CCC"}).overlayGeoJson(af.features,"state",function(ai){return ai.properties.name}).title(function(aj){var ai=options.i18n.noData;if(aj.value&&aj.value>0){ai=aj.key+": "+aj.value}else{ai=aj.key+": 0"}return ai});dc.renderAll()})})});